<?xml version="1.0" encoding="UTF-8"?>
<registry>
  <includes>
    <include>structs.xml</include>
  </includes>

  <handles>
    <handle name="Factory"/>
    <handle name="Adapter"/>
    <handle name="Device"/>
    <handle name="Fence"/>
    <handle name="ResourceAllocator"/>
    <handle name="RootSignature"/>
    <handle name="CommandQueue"/>
    <handle name="Shader"/>
    <handle name="PipelineState"/>
    <handle name="CommandList"/>
    <handle name="Buffer"/>
    <handle name="Texture"/>
    <handle name="SwapChain"/>
    <handle name="DebugMessenger"/>
    <handle name="RenderTarget"/>
    <handle name="DescriptorBuffer"/>
    <handle name="Sampler"/>
    <handle name="Memory"/>
    <handle name="ShaderResource"/>
    <handle name="FactoryExtension"/>
    <handle name="DeviceExtension"/>
  </handles>

  <!--Views-->
  <type name="FenceView" category="variant" for="Fence">
    <impl name="both">
      <member type="void" name="value" mod="ptr"/>
    </impl>
  </type>
  <type name="BufferView" category="variant" for="Buffer">
    <impl name="both">
      <member type="void" name="value" mod="ptr"/>
    </impl>
  </type>
  <type name="TextureView" category="variant" for="Texture">
    <impl name="dx">
      <member type="void" name="value" mod="ptr"/>
    </impl>
    <impl name="vk">
      <member type="void" name="value" mod="ptr"/>
      <member type="u32" name="value2"/>
      <member type="Size2D" name="value3"/>
    </impl>
  </type>
  <type name="RenderTargetView" category="variant" for="RenderTarget">
    <impl name="both">
      <member type="void" name="value" mod="ptr"/>
    </impl>
  </type>
  <type name="CommandListView" category="variant" for="CommandList">
    <impl name="both">
      <member type="void" name="value" mod="ptr"/>
    </impl>
  </type>
  <type name="ShaderView" category="variant" for="Shader">
    <impl name="dx">
      <member type="void" name="bytecode" mod="ptr"/>
      <member type="u32" name="size_bytes"/>
    </impl>
    <impl name="vk">
      <member type="void" name="value" mod="ptr"/>
    </impl>
  </type>
  <type name="RootSignatureView" category="variant" for="RootSignature">
    <impl name="dx">
      <member type="void" name="value" mod="ptr"/>
    </impl>
    <impl name="vk">
      <member type="void" name="value" mod="ptr"/>
    </impl>
  </type>
  <type name="DescriptorBufferView" category="variant" for="DescriptorBuffer">
    <impl name="dx">
      <member type="void" name="value" mod="ptr"/>
    </impl>
    <impl name="vk">
      <member type="u64" name="value1"/>
      <member type="u32" name="value2"/>
    </impl>
  </type>

  <functions>
    <func for="Factory" name="Destroy"/>
    <func for="Adapter" name="Destroy"/>
    <func for="Device" name="Destroy"/>
    <func for="Fence" name="Destroy"/>
    <func for="ResourceAllocator" name="Destroy"/>
    <func for="RootSignature" name="Destroy"/>
    <func for="CommandQueue" name="Destroy"/>
    <func for="Shader" name="Destroy"/>
    <func for="PipelineState" name="Destroy"/>
    <func for="CommandList" name="Destroy"/>
    <func for="Buffer" name="Destroy"/>
    <func for="Texture" name="Destroy"/>
    <func for="SwapChain" name="Destroy"/>
    <func for="DebugMessenger" name="Destroy"/>
    <func for="RenderTarget" name="Destroy"/>
    <func for="DescriptorBuffer" name="Destroy"/>
    <func for="Sampler" name="Destroy"/>
    <func for="Memory" name="Destroy"/>
    <func for="ShaderResource" name="Destroy"/>

    <!-- Free Functions -->
    <func name="CreateFactory">
      <ret type="Result" name="result"/>
      <ret type="Factory" name="factory"/>
      <arg type="bool" name="debug_layer" default="false"/>
    </func>

    <!-- CPP func only-->
    <func name="CreateFactoryWithExtensions" mod="cpp-only">
      <ret type="Result" name="result"/>
      <ret type="Factory" name="factory"/>
    </func>

    <func name="CreateDevice">
      <ret type="Result" name="result"/>
      <ret type="Device" name="device"/>
      <arg type="Adapter" name="adapter"/>
    </func>

    <func name="CreateDeviceWithExtensions" mod="cpp-only">
      <ret type="Result" name="result"/>
      <ret type="Device" name="device"/>
      <arg type="Adapter" name="adapter"/>
    </func>

    <func name="CreateDeviceWithExtensionsForce" mod="cpp-only">
      <ret type="Result" name="result"/>
      <ret type="Device" name="device"/>
      <arg type="Adapter" name="adapter"/>
      <arg type="bool" name="force"/>
    </func>

  </functions>
</registry>
